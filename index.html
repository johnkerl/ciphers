<!DOCTYPE html>
<html lang="en">

<head>

<!-- ================================================================ -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BZ8T9K9XYD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-BZ8T9K9XYD');
</script>
<!-- ================================================================ -->

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="description" content="Some classical ciphers">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- mobile-friendly -->
<meta name="keywords" content="ciphers caesar vigenere playfair polybius foursquare">

<title>Some classical ciphers</title>

<style>

  /* BODY */
  body {
    color: black;
    background-color: white;
    font-family: Verdana, sans-serif;
    font-size: 150%;
    letter-spacing: 0.25px;
    line-height: 125%;
  }
  h1 {
    font-weight: bold;
    color: maroon;
    font-size: 110%;
    text-align: center;
    margin: 40px;
  }
  h2 {
    font-weight: bold;
    color: maroon;
    font-size: 105%
  }
  h3 {
    font-weight: bold;
    color: maroon;
    font-size: 100%
  }
  a:link {
    color: maroon;
  }
  a:visited {
    color: maroon;
  }
  a:active {
    color: maroon;
  }

  .rounded {
    border-radius: 4px;
  }

  .larger-input-text {
    /* font-size: 100%; */
    font-size: 0.8em;
  }
  .boxed-text {
    border: 1px solid black;
    padding-top: 4px;
    padding-bottom: 4px;
    padding-left: 8px;
    padding-right: 8px;
  }
  .center {
    text-align: center;
  }
  .maroon {
    color: maroon;
  }

  /* TABLE */
  table {
    border: none;
  }
  /*
  for debug
  table {
    border: 1px solid;
    border-collapse: collapse;
    border-color: #808080;
  }
  td {
    border: 1px solid;
    border-collapse: collapse;
    border-color: #808080;
  }
  */

  .smallertext {
    font-size: 80%
  }

  /* ERROR-HANDLER */
  .error {
    color: red;
    background-color: white;
    padding: 10px;
    margin: 10px;
  }

  /* TEXT INPUTS */
  input {
    font-weight: bold;
    color: black;
  }

  /* BUTTONS */
  button {
    font-weight: bold;
    background-color: #e8e8e8;
    border: 0;
    padding: 4px;
    border-radius: 4px;
    margin: 4px;
  }
  button:hover {
    font-weight: bold;
    background-color: #d8d8d8;
    border: 0;
    padding: 4px;
    border-radius: 4px;
    margin: 4px;
  }
  button:active {
    font-weight: bold;
    background-color: #c0c0c0;
    border: 0;
    padding: 4px;
    border-radius: 4px;
    margin: 4px;
  }
  button.selected {
    font-weight: bold;
  }
  button.deselected {
    font-weight: normal;
  }
  button.no-margin {
    margin: 0px;
  }
  button.transparent {
    font-weight: normal;
    border: 0;
    background-color: transparent;
  }

  /* MODALS */
  /*
    There's a trick here (found on the web).
    * The modal background covers the *entire screen*.
    * The modal content is a little box within that.
    *
  */
  .modal-background {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Entire screen */
    height: 100%; /* Entire screen */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0, 0, 0); /* Fallback color in case alpha channel isn't supported */
    background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity -- stuff "under" the modal is dimmed */
  }
  .modal-content {
    background-color: white;
    border-radius: 4px;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: 2px solid gray;
    width: 80%;
  }

  /* THEME SELECTOR */
  .switch {
    position: relative;
    display: inline-block;
    width: 30px;
    height: 17px;
  }
  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    -webkit-transition: .4s;
    transition: .4s;
  }
  .slider:before {
    position: absolute;
    content: "";
    height: 13px;
    width: 13px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    -webkit-transition: .4s;
    transition: .4s;
  }
  input:checked + .slider {
    background-color: #2196F3;
  }
  input:focus + .slider {
    box-shadow: 0 0 1px #2196F3;
  }
  input:checked + .slider:before {
    -webkit-transform: translateX(13px);
    -ms-transform: translateX(13px);
    transform: translateX(13px);
  }
  .slider.round {
    border-radius: 17px;
  }
  .slider.round:before {
    border-radius: 50%;
  }

</style>

</head>

<!-- ================================================================ -->
<body>

<h1><span class="boxed-text rounded">Some classical ciphers</span></h1>

<!--
  This is a self-contained widget for error-text and cancel/X button.
  We use Sliver's setErrorWidget to route top-level errors here where
  they can be seen on the page.
-->
<span id="error-container" class="error">
  <button
    class=transparent
    onClick='
      document.getElementById("error-container").style.display = "none";
      document.getElementById("error-text").innerHTML = "";
    '
  > &times; </button>
  <span id="error-text"> </span>
</span>

<!-- fieldset allows a nice legend, of which I enjoy the styling -->
<fieldset class="rounded">
  <legend>
    <button id="shift-cipher-button" class="no-margin"> Loading ... </button>
    <button id="permutation-cipher-button" class="no-margin"> Loading ... </button>
    <button id="vigenere-cipher-button" class="no-margin"> Loading ... </button>
    <button id="playfair-cipher-button" class="no-margin"> Loading ... </button>
    <button id="foursquare-cipher-button" class="no-margin"> Loading ... </button>
  </legend>
  <table>

  <!-- Row for Foursquare cipher -->
  <tr id="foursquare-cipher-row-1">
    <td> <button class="maroon" id="clear-letters-button"> Loading ... </button> </td>
    <td>
      <input
        type=text
        tabindex=1
        placeholder="..."
        size=10
        autocapitalize="characters"
        id="foursquare-cipher-required-letters"
        class="larger-input-text"
      >
    </td>
    <td>&nbsp;</td>
    <td class="smallertext"> Required letter(s) </td>
  </tr>

  <!-- Row for Foursquare cipher -->
  <tr id="foursquare-cipher-row-2">
    <td> <button class="maroon" id="example-button">Loading ...</button> </td>
    <td>
      <input
        type=text
        tabindex=2
        placeholder="..."
        size=10
        autocapitalize="characters"
        id="foursquare-cipher-other-letters"
        class="larger-input-text"
      >
    </td>
    <td>&nbsp;</td>
    <td class="smallertext"> Other letter(s) </td>
  </tr>

  <!-- Row for Foursquare cipher -->
  <tr id="foursquare-cipher-row-3">
    <td> <button class="maroon" id="all-others-button">Loading ...</button> </td>
    <td> &nbsp; </td>
    <td>&nbsp;</td>
    <td> &nbsp; </td>
  </tr>

  <!-- Row for pattern cipher -->
  <tr id="vigenere-cipher-row-1">
    <td> <button class="maroon" id="pattern-clear-letters-button"> Loading ... </button> </td>
    <td>
      <input
        type=text
        tabindex=1
        placeholder="..."
        size=10
        id="vigenere-cipher-letters"
        class="larger-input-text"
      >
    </td>
    <td> &nbsp; </td>
    <td class="smallertext"> Letters, including <code>.</code> and <code>*</code> </td>
  </tr>

  <!-- Row for anagram cipher -->
  <tr id="playfair-cipher-row-1">
    <td> <button class="maroon" id="anagram-clear-letters-button"> Loading ... </button> </td>
    <td>
      <input
        type=text
        tabindex=1
        placeholder="..."
        size=10
        id="playfair-cipher-letters"
        class="larger-input-text"
      >
    </td>
    <td> &nbsp; </td>
    <td class="smallertext"> Letters </td>
  </tr>

  <!-- Row for shift cipher -->
  <tr id="shift-cipher-row-1">
    <td> <button class="maroon" id="shift-generate-button"> Loading ... </button> </td>
    <td style="width:3em">
      <input type="number" id="shift-count" style="width:5ch">
    </td>
    <td> &nbsp; </td>
    <td class="smallertext"> Word count </td>
  </tr>

  <!-- Row for permutation cipher -->
  <tr id="permutation-cipher-row-1">
    <td> <button class="maroon" id="permutation-generate-button"> Loading ... </button> </td>
    <td style="width:3em">
      <input type="number" id="permutation-word-count-input" style="width:5ch">
    </td>
    <td> &nbsp; </td>
    <td class="smallertext"> Word count </td>
  </tr>

  <!-- Row for permutation cipher -->
  <tr id="permutation-cipher-row-2">
    <td> &nbsp; </td>
    <td style="width:3em">
      <input type="number" id="permutation-n-input" style="width:3ch">
    </td>
    <td> &nbsp; </td>
    <td class="smallertext"> The <i>n</i> in <i>n</i>-gram </td>
  </tr>

  <!-- Min/max word lengths used by bee and pattern ciphers, but not anagram cipher or shift or permutation -->
  <tr id="match-lengths-row">
    <td> <button class="maroon" id="reset-match-lengths-button"> Reset </button> </td>
    <td>
      <span>
        <input tabindex=4 type="number" id="min-match-length" name="min-match-length" style="width:4ch">
        <input tabindex=5 type="number" id="max-match-length" name="max-match-length" style="width:4ch">
      </span>
    </td>
    <td>&nbsp;</td>
    <td class="smallertext"> <label>Min/max word lengths</label> </td>
  </tr>

  <tr>
    <td>
      <div>
        <button id="foursquare-cipher-help-launcher-button"> Help </button>
        <button id="vigenere-cipher-help-launcher-button"> Help </button>
        <button id="playfair-cipher-help-launcher-button"> Help </button>
        <button id="shift-cipher-help-launcher-button"> Help </button>
        <button id="permutation-cipher-help-launcher-button"> Help </button>
      </div>
    </td>
    <td> &nbsp; </td>
    <td> &nbsp; </td>
  </tr>

  </table>
</fieldset>

<!-- ================================================================ -->
<hr>

<div class=smallertext>
  Source and documentation:
  <br>
  <a href="https://github.com/johnkerl/ciphers/blob/main/README.md">github.com/johnkerl/ciphers</a>
</div>
<br>

<div class=smallertext>
  <label class="switch">
    <input type="checkbox" id="light-theme-dark-theme-toggle">
    <span class="slider round"></span>
  </label>
  <span id="light-theme-dark-theme-label">Loading ...</span>
</div>
<br>

<!-- ================================================================ -->

<!-- Modal content -->
<div id="foursquare-cipher-help-background" class="modal-background">
  <div id="foursquare-cipher-help-content" class="modal-content">
    <div>
      <button id="foursquare-cipher-help-close-button" class="general white-on-green" > Close </button>
    </div>
    <div>

    <p class="maroon">Help for Foursquare cipher:</p>

      <p>Enter your required letters and your other letters. (For the NYT Spelling Foursquare,
      this will be the center letter and the surrounding letters, respectively.)

      <p> You can further restrict your results by setting minimum and maximum word lengths.

    </div>
  </div>
</div>

<div id="vigenere-cipher-help-background" class="modal-background">
  <div id="vigenere-cipher-help-content" class="modal-content">
    <div>
      <button id="vigenere-cipher-help-close-button" class="general white-on-green" > Close </button>
    </div>
    <div>

    <p class="maroon">Help for pattern cipher:</p>

    <p> Enter your desired letters in the <code>Letters</code> field.</p>

    <p> You can use a <code>.</code> as a wildcard to match any single letter. For example, <code>LE.T</code>
    matches <code>LEFT</code>, <code>LENT</code>, <code>LEST</code>, etc.</p>

    <p> You can use a <code>*</code> as a wildcard to match zero or more of any letter. For example:</p>
    <ul>
      <li><code>OBOLUS</code> shows the one word <code>OBOLUS</code>, as a dictionary lookup</li>
      <li><code>THR*</code> shows all words that begin with <code>THR</code></li>
      <li><code>*EST</code> shows all words that end with <code>EST</code></li>
      <li><code>TH*TH</code> shows all words that begin and end with <code>TH</code> and</li>
      <li><code>*NIMB*</code> shows all words that have the sequence <code>NIMB</code> anywhere within.</li>
    </ul>

    <p> You can further restrict your results by setting minimum and maximum word lengths. </p>

    </div>
  </div>
</div>

<div id="playfair-cipher-help-background" class="modal-background">
  <div id="playfair-cipher-help-content" class="modal-content">
    <div>
      <button id="playfair-cipher-help-close-button" class="general white-on-green" > Close </button>
    </div>
    <div>

    <p class="maroon">Help for anagram cipher:</p>

    <p> Enter your desired letters in the Letters field.</p>

    <p> Results shown will be <a href="https://en.wikipedia.org/wiki/Anagram"
    target="_blank">anagrams</a> of the letters you provide. For example, <code>ELATES</code> will
    match <code>SEALET</code> but not <code>ELATE</code> or <code>SEALETS</code>.  </p>

    <p> Some words with many anagrams include <code>STOP</code>, <code>SLATE</code>,
    <code>PEARS</code>, and <code>TRIANGLE</code>.</p>

    </div>
  </div>
</div>

<div id="shift-cipher-help-background" class="modal-background">
  <div id="shift-cipher-help-content" class="modal-content">
    <div>
      <button id="shift-cipher-help-close-button" class="general white-on-green" > Close </button>
    </div>
    <div>

    <p class="maroon">Help for shift cipher:</p>

    <p> Select how many words to generate at a time.</p>
    <p> Use the Generate button to get a new random sample.</p>

    </div>
  </div>
</div>

<div id="permutation-cipher-help-background" class="modal-background">
  <div id="permutation-cipher-help-content" class="modal-content">
    <div>
      <button id="permutation-cipher-help-close-button" class="general white-on-green" > Close </button>
    </div>
    <div>

    <p class="maroon">Help for the Caesar cipher:</p>

    <p> Select how many words to generate at a time.</p>
    <p> Use the Generate button to get a new random sample.</p>

    </div>
  </div>
</div>

<!-- ================================================================ -->
<script type=module>
  'use strict';

  import {
    Button,
    ConstrainedTextInput,
    GenericElement,
    IntRangeInput,
    LightDarkThemeSlider,
    OneButtonSwitcher,
    PersistentDropdown,
    URLAndPersistentNButtonSwitcher,
    TextSpan,
    isInteger,
    setErrorWidget,
  // } from "http://127.0.1:9999/sliver/dev/sliver.js"
  // npx http-server ~/pub_http_internet -o -p 9999
  // } from "https://johnkerl.org/sliver/staging/sliver.js"
  // } from "https://johnkerl.org/sliver/stable/sliver.js"
  } from "./sliver.js" // local copy

  // ----------------------------------------------------------------
  setErrorWidget("error-container", "error-text")

  // ----------------------------------------------------------------
  class CiphersApp {

    constructor() {

      this.state = {
        "logLevel": 0, // 0,1,2,3

      }

      this.setElementsAndCallbacks()

//      if (this.elements.modeButtons.which() == 'foursquare-cipher-button') {
//        this.elements.requiredLettersElement.focus()
//      } else if (this.elements.modeButtons.which() == 'playfair-cipher-button') {
//        this.elements.anagramLettersElement.focus()
//      } else if (this.elements.modeButtons.which() == 'vigenere-cipher-button') {
//        this.elements.patternLettersElement.focus()
//      } else if (this.elements.modeButtons.which() == 'shift-cipher-button') {
//        this.elements.shiftCipherButton.focus()
//      } else if (this.elements.modeButtons.which() == 'permutation-cipher-button') {
//        this.elements.ngramGenerateButton.focus()
//      }

    }

    setElementsAndCallbacks() {
      this.elements = {}

//      // foursquare-cipher element
//      this.elements.requiredLettersElement = new ConstrainedTextInput(
//        "foursquare-cipher-required-letters",
//        (text) => text.toUpperCase(),
//        //(text) => text,
//        (event) => {
//          this.logAt1("REQUIRED-LETTERS INPUT: <<", event.target.value, ">>")
//          this.showFoursquareModeMatches()
//      })

//      // foursquare-cipher element
//      this.elements.otherLettersElement = new ConstrainedTextInput(
//        "foursquare-cipher-other-letters",
//        (text) => text.toUpperCase(),
//        //(text) => text,
//        (event) => {
//          this.logAt1("OTHER-LETTERS INPUT: <<", event.target.value, ">>")
//          this.showFoursquareModeMatches()
//      })

//      // vigenere-cipher element
//      this.elements.patternLettersElement = new ConstrainedTextInput(
//        "vigenere-cipher-letters",
//        //(text) => text.toUpperCase(),
//        (text) => text,
//        (event) => {
//          this.logAt1("PATTERN-LETTERS INPUT: <<", event.target.value, ">>")
//          this.showVigenereModeMatches()
//      })

//      // playfair-cipher element
//      this.elements.anagramLettersElement = new ConstrainedTextInput(
//        "playfair-cipher-letters",
//        //(text) => text.toUpperCase(),
//        (text) => text,
//        (event) => {
//          this.logAt1("ANAGRAM-LETTERS INPUT: <<", event.target.value, ">>")
//          this.showPlayfairCipherMatches()
//      })

//      let minMatchLengthElement = new IntRangeInput(
//        "min-match-length",
//        this.state.defaultLowMatchLength, // default
//        this.state.minMatchLength, // min
//        this.state.maxMatchLength, // max
//        (event) => {
//          this.showMatches()
//        },
//      )

//      let maxMatchLengthElement = new IntRangeInput(
//        "max-match-length",
//        this.state.defaultHighMatchLength, // default
//        this.state.minMatchLength, // min
//        this.state.maxMatchLength, // max
//        (event) => {
//          this.showMatches()
//        },
//      )

//      // TODO: do this coupling at the class level -- IntRangeInputPair maybe -- with resetter
//      minMatchLengthElement.setPeerMax(maxMatchLengthElement)
//      maxMatchLengthElement.setPeerMin(minMatchLengthElement)

//      this.elements.minMatchLengthElement = minMatchLengthElement
//      this.elements.maxMatchLengthElement = maxMatchLengthElement

//      // foursquare-cipher element
//      this.elements.clearLettersButton = new Button(
//        "clear-letters-button",
//        "Clear",
//        (event) => {
//          this.logAt1("CLEAR-LETTERS BUTTON WAS CLICKED")
//          this.elements.requiredLettersElement.set("")
//          this.elements.otherLettersElement.set("")
//          this.showFoursquareModeMatches()
//        },
//      )

//      // foursquare-cipher element
//      this.elements.exampleButton = new Button(
//        "example-button",
//        "Example",
//        (event) => {
//          this.logAt1("EXAMPLE BUTTON WAS CLICKED")

//          this.elements.requiredLettersElement.set("E")
//          this.elements.otherLettersElement.set("XAMPLS")
//          this.elements.outputElement.set("")

//          this.showFoursquareModeMatches()
//        },
//      )

//      // foursquare-cipher element
//      this.elements.allOthersButton = new Button(
//        "all-others-button",
//        "A-Z",
//        (event) => {
//          this.logAt1("A-Z BUTTON WAS CLICKED")
//
//          this.elements.requiredLettersElement.set("")
//          this.elements.otherLettersElement.set("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
//          this.elements.outputElement.set("")
//
//          this.showFoursquareModeMatches()
//        },
//      )

//      // vigenere-cipher element
//      this.elements.patternClearLettersButton = new Button(
//        "pattern-clear-letters-button",
//        "Clear",
//        (event) => {
//          this.logAt1("PATTERN-CLEAR-LETTERS BUTTON WAS CLICKED")
//          this.elements.patternLettersElement.set("")
//          this.showVigenereModeMatches()
//        },
//      )

//      // playfair-cipher element
//      this.elements.anagramClearLettersButton = new Button(
//        "anagram-clear-letters-button",
//        "Clear",
//        (event) => {
//          this.logAt1("ANAGRAM-CLEAR-LETTERS BUTTON WAS CLICKED")
//          this.elements.anagramLettersElement.set("")
//          this.showPlayfairCipherMatches()
//        },
//      )

//      // shift-cipher element
//      this.elements.shiftCipherButton = new Button(
//        "shift-generate-button",
//        "Generate",
//        (event) => {
//          this.logAt1("shift-GENERATE BUTTON WAS CLICKED")
//          this.generateRandomWords()
//        },
//      )

//      // shift-cipher element
//      this.elements.randomWordCountInput = new IntRangeInput(
//        "shift-count",
//        this.state.defaultRandomWordCount, // default
//        this.state.minRandomWordCount, // min
//        this.state.maxRandomWordCount, // max
//        (event) => {
//          this.generateRandomWords()
//        },
//      )

//      // permutation-cipher element
//      this.elements.ngramGenerateButton = new Button(
//        "permutation-generate-button",
//        "Generate",
//        (event) => {
//          this.logAt0("PERMUTATION-GENERATE BUTTON WAS CLICKED")
//          // Do not recompute the NGramsKeeper -- re-use it
//          this.generateNGramWords()
//        },
//      )

//      // permutation-cipher element
//      this.elements.ngramWordCountInput = new IntRangeInput(
//        "permutation-word-count-input",
//        this.state.defaultNGramWordCount, // default
//        this.state.minNGramWordCount, // min
//        this.state.maxNGramWordCount, // max
//        (event) => {
//          this.logAt0("PERMUTATION-WORD-COUNT INPUT WAS SELECTED")
//          this.generateNGramWords()
//        },
//      )

//      // permutation-cipher element
//      console
//      this.elements.ngramNInput = new IntRangeInput(
//        "permutation-n-input",
//        this.state.defaultNGramN, // default
//        this.state.minNGramN, // min
//        this.state.maxNGramN, // max
//        (event) => {
//          this.logAt0("PERMUTATION-N INPUT WAS SELECTED")
//          // Recompute the NGramsKeeper
//          this.ngramsKeeper = null
//          this.generateNGramWords()
//        },
//      )

//      this.elements.resetMatchLengthsButton = new Button(
//        "reset-match-lengths-button",
//        "Reset",
//        (event) => {
//          this.logAt1("RESET-MATCH-LENGTHS BUTTON WAS CLICKED")
//          this.elements.minMatchLengthElement.resetToDefault(),
//          this.elements.maxMatchLengthElement.resetToDefault(),
//          this.showMatches()
//        },
//      )

//      this.elements.matchLengthsRow = new GenericElement("match-lengths-row")

      this.elements.modeButtons = new URLAndPersistentNButtonSwitcher( {

          "shift-cipher-button": {
            "text": "Shift",
            "items": [
              new GenericElement("shift-cipher-row-1"),
              new GenericElement("shift-cipher-help-launcher-button"),
            ],
            "callback": () => {
              // The tab button being clicked gets the focus.
              // So we have to delay.
              // this.elements.shiftCipherButton.focus()
              setTimeout(
                () => {
                  //this.elements.shiftCipherButton.focus()
                },
                200,
              )
            },
            "urlShorthand": "shift",
          },

          "permutation-cipher-button": {
            "text": "Permutation",
            "items": [
              new GenericElement("permutation-cipher-row-1"),
              new GenericElement("permutation-cipher-row-2"),
              new GenericElement("permutation-cipher-help-launcher-button"),
            ],
            "callback": () => {
              this.logAt0("SWTICH TO PERMUTATION CIPHER")
              this.elements.matchLengthsRow.makeInvisible()

              // The tab button being clicked gets the focus.
              // So we have to delay.
              // this.elements.ngramGenerateButton.focus()
              setTimeout(
                () => {
                  this.elements.ngramGenerateButton.focus()
                },
                200,
              )

              this.ngramsKeeper = null
              this.generateNGramWords()
            },
            "urlShorthand": "permutation",
          },

          "vigenere-cipher-button": {
            "text": "Vigenère",
            "items": [
              new GenericElement("vigenere-cipher-row-1"),
              new GenericElement("vigenere-cipher-help-launcher-button"),
            ],
            "callback": () => {
              this.ngramsKeeper = null
              this.elements.matchLengthsRow.makeVisible()

              // The tab button being clicked gets the focus.
              // So we have to delay.
              // this.elements.patternLettersElement.focus()
              setTimeout(
                () => {
                  this.elements.patternLettersElement.focus()
                },
                200,
              )

              this.showMatches()
            },
            "urlShorthand": "pattern",
          },

          "playfair-cipher-button": {
            "text": "Playfair",
            "items": [
              new GenericElement("playfair-cipher-row-1"),
              new GenericElement("playfair-cipher-help-launcher-button"),
            ],
            "callback": () => {
              this.ngramsKeeper = null
              this.elements.matchLengthsRow.makeInvisible()

              // The tab button being clicked gets the focus.
              // So we have to delay.
              // this.elements.anagramLettersElement.focus()
              setTimeout(
                () => {
                  this.elements.anagramLettersElement.focus()
                },
                200,
              )

              this.showMatches()
            },
            "urlShorthand": "anagram",
          },

          "foursquare-cipher-button": {
            "text": "Foursquare",
            "items": [
              new GenericElement("foursquare-cipher-row-1"),
              new GenericElement("foursquare-cipher-row-2"),
              new GenericElement("foursquare-cipher-row-3"),
              new GenericElement("foursquare-cipher-help-launcher-button"),
            ],
            "callback": () => {
              this.ngramsKeeper = null
              this.elements.matchLengthsRow.makeVisible()

              // The tab button being clicked gets the focus.
              // So we have to delay.
              // this.elements.requiredLettersElement.focus()
              setTimeout(
                () => {
                  this.elements.requiredLettersElement.focus()
                },
                200,
              )

              this.showMatches()
            },
            "urlShorthand": "bee",
          },

        },
        "selected",   // CSS style class
        "deselected", // CSS style class
      )


      // ----------------------------------------------------------------

      this.elements.bee_mode_help_background  = new GenericElement("foursquare-cipher-help-background")
      this.elements.bee_mode_help_content  = new GenericElement("foursquare-cipher-help-content")

      this.elements.bee_mode_help_launcherButton = new Button(
        "foursquare-cipher-help-launcher-button",
        null,
        (event) => {
          this.elements.bee_mode_help_background.makeVisible("block")
          this.elements.bee_mode_help_background.underlying.style.display = "block"
        },
      )

      this.elements.bee_mode_help_close_button = new Button(
        "foursquare-cipher-help-close-button",
        null,
        (event) => {
          this.elements.bee_mode_help_background.makeInvisible()
        },
      )

      // ----------------------------------------------------------------
      this.elements.pattern_mode_help_background  = new GenericElement("vigenere-cipher-help-background")
      this.elements.pattern_mode_help_content  = new GenericElement("vigenere-cipher-help-content")

      this.elements.pattern_mode_help_launcherButton = new Button(
        "vigenere-cipher-help-launcher-button",
        null,
        (event) => {
          this.elements.pattern_mode_help_background.makeVisible("block")
          this.elements.pattern_mode_help_background.underlying.style.display = "block"
        },
      )

      this.elements.pattern_mode_help_close_button = new Button(
        "vigenere-cipher-help-close-button",
        null,
        (event) => {
          this.elements.pattern_mode_help_background.makeInvisible()
        },
      )

      // ----------------------------------------------------------------
      this.elements.anagram_mode_help_background  = new GenericElement("playfair-cipher-help-background")
      this.elements.anagram_mode_help_content  = new GenericElement("playfair-cipher-help-content")

      this.elements.anagram_mode_help_launcherButton = new Button(
        "playfair-cipher-help-launcher-button",
        null,
        (event) => {
          this.elements.anagram_mode_help_background.makeVisible("block")
          this.elements.anagram_mode_help_background.underlying.style.display = "block"
        },
      )

      this.elements.anagram_mode_help_close_button = new Button(
        "playfair-cipher-help-close-button",
        null,
        (event) => {
          this.elements.anagram_mode_help_background.makeInvisible()
        },
      )

      // ----------------------------------------------------------------
      this.elements.random_word_mode_help_background  = new GenericElement("shift-cipher-help-background")
      this.elements.random_word_mode_help_content  = new GenericElement("shift-cipher-help-content")

      this.elements.random_word_mode_help_launcherButton = new Button(
        "shift-cipher-help-launcher-button",
        null,
        (event) => {
          this.elements.random_word_mode_help_background.makeVisible("block")
          this.elements.random_word_mode_help_background.underlying.style.display = "block"
        },
      )

      this.elements.random_word_mode_help_close_button = new Button(
        "shift-cipher-help-close-button",
        null,
        (event) => {
          this.elements.random_word_mode_help_background.makeInvisible()
        },
      )

      // ----------------------------------------------------------------
      this.elements.permutation_cipher_help_background  = new GenericElement("permutation-cipher-help-background")
      this.elements.permutation_cipher_help_content  = new GenericElement("permutation-cipher-help-content")

      this.elements.permutation_cipher_help_launcherButton = new Button(
        "permutation-cipher-help-launcher-button",
        null,
        (event) => {
          this.elements.permutation_cipher_help_background.makeVisible("block")
          this.elements.permutation_cipher_help_background.underlying.style.display = "block"
        },
      )

      this.elements.permutation_cipher_help_close_button = new Button(
        "permutation-cipher-help-close-button",
        null,
        (event) => {
          this.elements.permutation_cipher_help_background.makeInvisible()
        },
      )

      // ----------------------------------------------------------------
      // This is a hack to get the escape key to close the help modal on desktop.
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          window.app.elements.bee_mode_help_background.makeInvisible()
          window.app.elements.pattern_mode_help_background.makeInvisible()
          window.app.elements.anagram_mode_help_background.makeInvisible()
          window.app.elements.random_word_mode_help_background.makeInvisible()
          window.app.elements.permutation_cipher_help_background.makeInvisible()
        }
      });

      // ----------------------------------------------------------------
      // This is a hack. I need to research CSS theming.
      this.elements.lightDarkThemeElement = new LightDarkThemeSlider(
        "light-theme-dark-theme-toggle",
        "light-theme-dark-theme-label",
        (event) => {
          document.body.style.backgroundColor = "white"
          document.body.style.color = "black"
          this.elements.bee_mode_help_content.underlying.style.backgroundColor         = "white"
          this.elements.bee_mode_help_content.underlying.style.color                   = "black"
          this.elements.pattern_mode_help_content.underlying.style.backgroundColor     = "white"
          this.elements.pattern_mode_help_content.underlying.style.color               = "black"
          this.elements.anagram_mode_help_content.underlying.style.backgroundColor     = "white"
          this.elements.anagram_mode_help_content.underlying.style.color               = "black"
          this.elements.random_word_mode_help_content.underlying.style.backgroundColor = "white"
          this.elements.random_word_mode_help_content.underlying.style.color           = "black"
          this.elements.permutation_cipher_help_content.underlying.style.backgroundColor       = "white"
          this.elements.permutation_cipher_help_content.underlying.style.color                 = "black"
        },
        (event) => {
          document.body.style.backgroundColor = "black"
          document.body.style.color = "white"
          this.elements.bee_mode_help_content.underlying.style.backgroundColor         = "black"
          this.elements.bee_mode_help_content.underlying.style.color                   = "white"
          this.elements.pattern_mode_help_content.underlying.style.backgroundColor     = "black"
          this.elements.pattern_mode_help_content.underlying.style.color               = "white"
          this.elements.anagram_mode_help_content.underlying.style.backgroundColor     = "black"
          this.elements.anagram_mode_help_content.underlying.style.color               = "white"
          this.elements.random_word_mode_help_content.underlying.style.backgroundColor = "black"
          this.elements.random_word_mode_help_content.underlying.style.color           = "white"
          this.elements.permutation_cipher_help_content.underlying.style.backgroundColor       = "black"
          this.elements.permutation_cipher_help_content.underlying.style.color                 = "white"
        },
      )

    }

    // ----------------------------------------------------------------
    // LOGGING METHODS

    logAt0(...args) {
      this.logAt(0, ...args)
    }

    logAt1(...args) {
      this.logAt(1, ...args)
    }

    logAt2(...args) {
      this.logAt(2, ...args)
    }

    logAt3(...args) {
      this.logAt(3, ...args)
    }

    logAt(level, ...args) {
      if (this.state.logLevel >= level) {
        console.log(...args)
      }
    }

  }

  // ----------------------------------------------------------------
  const app = new CiphersApp()
  // Expose from module visibility to top-level visibility for Console use
  window.app = app

</script>
<!-- ================================================================ -->
</body>
</html>
